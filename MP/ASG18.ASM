PAGE 30,132
TITLE STRSORT
.MODEL SMALL
.STACK 100H 
.DATA
S1 DB 'ABA','$'
T1 DB 'AAA','$'
D3 DB 'ABB','$'
P4 DB 'BAB','$'
ARR DW 4 DUP(0)
LN1 DB ?
LN2 DB ?
STO DW ?
CN DB ?
CN2 DB ?
MS1 DB 10D,13D,'$'
MS2 DB 'SORTED STRINGS ARE','$'
MS3 DB 'UNSORTED STRINGS ARE','$'
;MS3 DB 'EQUAL STRINGS','$'
.CODE
MAIN PROC FAR
 MOV AX,@DATA
 MOV DS,AX
ABC:
 LEA DI,ARR
 LEA SI,S1
 MOV [DI],SI
 INC DI
 INC DI
 LEA SI,T1
  MOV [DI],SI
 INC DI
 INC DI
 LEA SI,D3
  MOV [DI],SI
 INC DI
 INC DI
 LEA SI,P4
  MOV [DI],SI
 INC DI
 INC DI

 MOV CN,04
 XXX:
  MOV BL,CN
  MOV CN2,BL
  SUB CN2,01
  ;MOV IND1,00
  LEA DI,ARR
  MOV STO,DI
   YYY:
    JMP SORT
	ZZZ:
    MOV DI,STO
	INC DI
	INC DI
	MOV STO,DI
	DEC CN2
	JNZ YYY
  DEC CN
  JNZ XXX
 JMP WWW
 
SORT:
 MOV SI,[DI]
 MOV CL,00
 L1:
  MOV BL,'$'
  CMP [SI],BL
  JE BBB
  INC SI
  INC CL
  JMP L1
 BBB:
  MOV LN1,CL
  MOV CL,00
  MOV SI,[DI+2]
  L2:
  MOV BL,'$'
  CMP [SI],BL
  JE CCC
  INC SI
  INC CL
  JMP L2
 CCC:
  MOV LN2,CL
  CMP CL,LN1
  JAE DDD
  MOV CL,LN1
  JMP EEE
   DDD:
    MOV CL,LN2
 EEE:
  MOV AL,[DI]
  MOV AH,[DI+1]
  MOV SI,AX
  MOV AL,[DI+2]
  MOV AH,[DI+3]
  MOV DI,AX
   L3:
    MOV BL,[SI]
    CMP [DI],BL
	JA KKK
	CMP [DI],BL
	JB LLL
	INC SI
	INC DI
	DEC CL
    JNZ L3	
  MOV BL,LN1
  CMP LN2,BL
  JA KKK
  CMP LN2,BL
  JB LLL
  ;MOV AH,09H
  ;INT 21H
  JMP ZZZ
   KKK:
   MOV DI,STO
   MOV DL,[DI]
   MOV DH,[DI+1]
  MOV BL,[DI+2]
  MOV BH,[DI+3]
  MOV [DI],BX
  MOV [DI+2],DX
	JMP ZZZ
  LLL:
   ;LEA DX,MS2
	;MOV AH,09H
	;INT 21H
	JMP ZZZ
WWW:
LEA SI,ARR
MOV CL,4
LEA DX,MS2
MOV AH,09H
INT 21H
LEA DX,MS1
MOV AH,09H
INT 21H
 L12:
  MOV DL,[SI]
  INC SI
  MOV DH,[SI]
  MOV AH,09H
  INT 21H
  LEA DX,MS1
  MOV AH,09H
  INT 21H
  ;INC SI
  INC SI
  DEC CL
  JNZ L12
MOV AH,4CH
INT 21H
MAIN ENDP 
END MAIN
